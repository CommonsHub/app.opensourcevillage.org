# Profile API

Endpoints for managing user profiles.

## GET /api/profile/:identifier

Get a user's profile by username or npub.

### Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `identifier` | string | Username or npub |

### Response

```json
{
  "success": true,
  "profile": {
    "npub": "npub1...",
    "username": "alice",
    "name": "Alice Smith",
    "shortbio": "Web3 developer",
    "avatar": "/api/avatar/npub1...",
    "createdAt": "2026-01-22T10:00:00Z",
    "updatedAt": "2026-01-22T12:00:00Z"
  },
  "balance": {
    "confirmed": 45,
    "pending": 5,
    "total": 50
  }
}
```

### Errors

| Status | Error | Description |
|--------|-------|-------------|
| 404 | Profile not found | No profile with that identifier |

### Example

```bash
# By username
curl http://localhost:3000/api/profile/alice

# By npub
curl http://localhost:3000/api/profile/npub1abc123...
```

## PUT /api/profile/:identifier

Update a user's profile.

### Request

```json
{
  "name": "Alice Smith",
  "shortbio": "Building the future of open source",
  "event": {
    "id": "...",
    "pubkey": "...",
    "kind": 0,
    "content": "{\"name\":\"Alice Smith\",\"about\":\"...\"}",
    "tags": [],
    "created_at": 1706000000,
    "sig": "..."
  }
}
```

The request must include a signed NOSTR kind:0 event to verify ownership.

### Parameters

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `name` | string | No | Display name |
| `shortbio` | string | No | Short biography |
| `event` | NostrEvent | Yes | Signed kind:0 event |

### Response

```json
{
  "success": true,
  "profile": {
    "npub": "npub1...",
    "username": "alice",
    "name": "Alice Smith",
    "shortbio": "Building the future of open source",
    "updatedAt": "2026-01-22T14:00:00Z"
  }
}
```

### Errors

| Status | Error | Description |
|--------|-------|-------------|
| 400 | Invalid or missing NOSTR event | Event validation failed |
| 403 | Not authorized | Event pubkey doesn't match profile |
| 404 | Profile not found | No profile with that identifier |
